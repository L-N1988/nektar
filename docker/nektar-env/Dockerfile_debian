FROM debian:%%DEBIAN_VERSION%%-slim

LABEL maintainer="Nektar++ Development Team <nektar-users@imperial.ac.uk>"

ENV DEBIAN_VERSION %%DEBIAN_VERSION%%
ENV BUILD_TYPE %%BUILD_TYPE%%
COPY docker/nektar-env/${DEBIAN_VERSION}_${BUILD_TYPE}_packages.txt packages.txt

RUN echo "deb http://deb.debian.org/debian ${DEBIAN_VERSION} non-free" > \
        /etc/apt/sources.list.d/debian-non-free.list && \
        apt-get update && \
        apt-get install -y $(cat packages.txt) \
        && rm -rf /var/lib/apt/lists/*
RUN ln -s /usr/bin/ccache /usr/local/bin/cc && ln -s /usr/bin/ccache /usr/local/bin/c++ 

RUN groupadd nektar && useradd -m -g nektar nektar
USER nektar:nektar
WORKDIR /home/nektar
