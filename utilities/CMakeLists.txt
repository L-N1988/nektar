MACRO(ADD_UTILITIES_EXECUTABLE name)
    CMAKE_PARSE_ARGUMENTS(UTIL "" "COMPONENT" "SOURCES;DEPENDS" ${ARGN})

    IF(NOT UTIL_DEPENDS)
        SET(UTIL_DEPENDS MultiRegions)
    ENDIF()

    ADD_NEKTAR_EXECUTABLE(${name}
        COMPONENT ${UTIL_COMPONENT} DEPENDS ${UTIL_DEPENDS} SOURCES ${UTIL_SOURCES})
ENDMACRO()

INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/library ${CMAKE_SOURCE_DIR}/utilities)

CMAKE_DEPENDENT_OPTION(NEKTAR_UTILITY_NEKMESH
    "Build the NekMesh pre-processing utility." ON
    "NEKTAR_BUILD_UTILITIES" OFF)
CMAKE_DEPENDENT_OPTION(NEKTAR_UTILITY_FIELDCONVERT
    "Build the FieldConvert post-processing utility." ON
    "NEKTAR_BUILD_UTILITIES" OFF)
CMAKE_DEPENDENT_OPTION(NEKTAR_UTILITY_EXTRAS
    "Build extra Nektar++ utilities." OFF
    "NEKTAR_BUILD_UTILITIES" OFF)

# Generate list of available utilities
IF(NEKTAR_UTILITY_NEKMESH AND NEKTAR_BUILD_UTILITIES)
    SUBDIRS(NekMesh)
ENDIF()
IF(NEKTAR_UTILITY_FIELDCONVERT AND NEKTAR_BUILD_UTILITIES)
    SUBDIRS(FieldConvert)
ENDIF()
IF(NEKTAR_UTILITY_EXTRAS AND NEKTAR_BUILD_UTILITIES)
    SUBDIRS(Extras)
ENDIF()