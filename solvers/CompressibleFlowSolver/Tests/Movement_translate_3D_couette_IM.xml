<?xml version="1.0" encoding="utf-8" ?>
<NEKTAR>
    <GEOMETRY DIM="3" SPACE="3">
        <VERTEX>
            <V ID="0">0.00000000e+00 5.00000000e-01 5.00000000e-01</V>
            <V ID="1">0.00000000e+00 0.00000000e+00 5.00000000e-01</V>
            <V ID="2">0.00000000e+00 0.00000000e+00 0.00000000e+00</V>
            <V ID="3">0.00000000e+00 5.00000000e-01 0.00000000e+00</V>
            <V ID="4">5.00000000e-01 5.00000000e-01 5.00000000e-01</V>
            <V ID="5">5.00000000e-01 0.00000000e+00 5.00000000e-01</V>
            <V ID="6">5.00000000e-01 0.00000000e+00 0.00000000e+00</V>
            <V ID="7">5.00000000e-01 5.00000000e-01 0.00000000e+00</V>
            <V ID="8">0.00000000e+00 1.00000000e+00 5.00000000e-01</V>
            <V ID="9">0.00000000e+00 1.00000000e+00 0.00000000e+00</V>
            <V ID="10">5.00000000e-01 1.00000000e+00 5.00000000e-01</V>
            <V ID="11">5.00000000e-01 1.00000000e+00 0.00000000e+00</V>
            <V ID="12">0.00000000e+00 5.00000000e-01 1.00000000e+00</V>
            <V ID="13">0.00000000e+00 0.00000000e+00 1.00000000e+00</V>
            <V ID="14">5.00000000e-01 5.00000000e-01 1.00000000e+00</V>
            <V ID="15">5.00000000e-01 0.00000000e+00 1.00000000e+00</V>
            <V ID="16">0.00000000e+00 1.00000000e+00 1.00000000e+00</V>
            <V ID="17">5.00000000e-01 1.00000000e+00 1.00000000e+00</V>
            <V ID="18">5.00000000e-01 5.00000000e-01 5.00000000e-01</V>
            <V ID="19">5.00000000e-01 0.00000000e+00 5.00000000e-01</V>
            <V ID="20">5.00000000e-01 0.00000000e+00 0.00000000e+00</V>
            <V ID="21">5.00000000e-01 5.00000000e-01 0.00000000e+00</V>
            <V ID="22">1.00000000e+00 5.00000000e-01 5.00000000e-01</V>
            <V ID="23">1.00000000e+00 0.00000000e+00 5.00000000e-01</V>
            <V ID="24">1.00000000e+00 0.00000000e+00 0.00000000e+00</V>
            <V ID="25">1.00000000e+00 5.00000000e-01 0.00000000e+00</V>
            <V ID="26">5.00000000e-01 1.00000000e+00 5.00000000e-01</V>
            <V ID="27">5.00000000e-01 1.00000000e+00 0.00000000e+00</V>
            <V ID="28">1.00000000e+00 1.00000000e+00 5.00000000e-01</V>
            <V ID="29">1.00000000e+00 1.00000000e+00 0.00000000e+00</V>
            <V ID="30">5.00000000e-01 5.00000000e-01 1.00000000e+00</V>
            <V ID="31">5.00000000e-01 0.00000000e+00 1.00000000e+00</V>
            <V ID="32">1.00000000e+00 5.00000000e-01 1.00000000e+00</V>
            <V ID="33">1.00000000e+00 0.00000000e+00 1.00000000e+00</V>
            <V ID="34">5.00000000e-01 1.00000000e+00 1.00000000e+00</V>
            <V ID="35">1.00000000e+00 1.00000000e+00 1.00000000e+00</V>
        </VERTEX>
        <EDGE>
            <E ID="0">0 1</E>
            <E ID="1">1 2</E>
            <E ID="2">2 3</E>
            <E ID="3">3 0</E>
            <E ID="4">0 4</E>
            <E ID="5">1 5</E>
            <E ID="6">2 6</E>
            <E ID="7">3 7</E>
            <E ID="8">4 5</E>
            <E ID="9">5 6</E>
            <E ID="10">6 7</E>
            <E ID="11">7 4</E>
            <E ID="12">8 0</E>
            <E ID="13">3 9</E>
            <E ID="14">9 8</E>
            <E ID="15">8 10</E>
            <E ID="16">9 11</E>
            <E ID="17">10 4</E>
            <E ID="18">7 11</E>
            <E ID="19">11 10</E>
            <E ID="20">12 13</E>
            <E ID="21">13 1</E>
            <E ID="22">0 12</E>
            <E ID="23">12 14</E>
            <E ID="24">13 15</E>
            <E ID="25">14 15</E>
            <E ID="26">15 5</E>
            <E ID="27">4 14</E>
            <E ID="28">16 12</E>
            <E ID="29">8 16</E>
            <E ID="30">16 17</E>
            <E ID="31">17 14</E>
            <E ID="32">10 17</E>
            <E ID="33">18 19</E>
            <E ID="34">19 20</E>
            <E ID="35">20 21</E>
            <E ID="36">21 18</E>
            <E ID="37">18 22</E>
            <E ID="38">19 23</E>
            <E ID="39">20 24</E>
            <E ID="40">21 25</E>
            <E ID="41">22 23</E>
            <E ID="42">23 24</E>
            <E ID="43">24 25</E>
            <E ID="44">25 22</E>
            <E ID="45">26 18</E>
            <E ID="46">21 27</E>
            <E ID="47">27 26</E>
            <E ID="48">26 28</E>
            <E ID="49">27 29</E>
            <E ID="50">28 22</E>
            <E ID="51">25 29</E>
            <E ID="52">29 28</E>
            <E ID="53">30 31</E>
            <E ID="54">31 19</E>
            <E ID="55">18 30</E>
            <E ID="56">30 32</E>
            <E ID="57">31 33</E>
            <E ID="58">32 33</E>
            <E ID="59">33 23</E>
            <E ID="60">22 32</E>
            <E ID="61">34 30</E>
            <E ID="62">26 34</E>
            <E ID="63">34 35</E>
            <E ID="64">35 32</E>
            <E ID="65">28 35</E>
        </EDGE>
        <FACE>
            <Q ID="0">0 1 2 3</Q>
            <Q ID="1">0 5 8 4</Q>
            <Q ID="2">1 6 9 5</Q>
            <Q ID="3">2 6 10 7</Q>
            <Q ID="4">3 7 11 4</Q>
            <Q ID="5">8 9 10 11</Q>
            <Q ID="6">12 3 13 14</Q>
            <Q ID="7">12 4 17 15</Q>
            <Q ID="8">13 7 18 16</Q>
            <Q ID="9">14 16 19 15</Q>
            <Q ID="10">17 11 18 19</Q>
            <Q ID="11">20 21 0 22</Q>
            <Q ID="12">20 24 25 23</Q>
            <Q ID="13">21 5 26 24</Q>
            <Q ID="14">22 4 27 23</Q>
            <Q ID="15">25 26 8 27</Q>
            <Q ID="16">28 22 12 29</Q>
            <Q ID="17">28 23 31 30</Q>
            <Q ID="18">29 15 32 30</Q>
            <Q ID="19">31 27 17 32</Q>
            <Q ID="20">33 34 35 36</Q>
            <Q ID="21">33 38 41 37</Q>
            <Q ID="22">34 39 42 38</Q>
            <Q ID="23">35 39 43 40</Q>
            <Q ID="24">36 40 44 37</Q>
            <Q ID="25">41 42 43 44</Q>
            <Q ID="26">45 36 46 47</Q>
            <Q ID="27">45 37 50 48</Q>
            <Q ID="28">46 40 51 49</Q>
            <Q ID="29">47 49 52 48</Q>
            <Q ID="30">50 44 51 52</Q>
            <Q ID="31">53 54 33 55</Q>
            <Q ID="32">53 57 58 56</Q>
            <Q ID="33">54 38 59 57</Q>
            <Q ID="34">55 37 60 56</Q>
            <Q ID="35">58 59 41 60</Q>
            <Q ID="36">61 55 45 62</Q>
            <Q ID="37">61 56 64 63</Q>
            <Q ID="38">62 48 65 63</Q>
            <Q ID="39">64 60 50 65</Q>
        </FACE>
        <ELEMENT>
            <H ID="0">0 1 2 3 4 5 </H>
            <H ID="1">6 7 4 8 9 10 </H>
            <H ID="2">11 12 13 1 14 15 </H>
            <H ID="3">16 17 14 7 18 19 </H>
            <H ID="4">20 21 22 23 24 25 </H>
            <H ID="5">26 27 24 28 29 30 </H>
            <H ID="6">31 32 33 21 34 35 </H>
            <H ID="7">36 37 34 27 38 39 </H>
        </ELEMENT>
        <CURVED />
        <COMPOSITE>
            <C ID="401"> F[0,6,11,16] </C>
            <C ID="402"> F[25,30,35,39] </C>
            <C ID="403"> F[9,18,29,38] </C>
            <C ID="404"> F[2,13,22,33] </C>
            <C ID="405"> F[12,17,32,37] </C>
            <C ID="406"> F[3,8,23,28] </C>
            <C ID="407"> F[10,5,19,15] </C>
            <C ID="408"> F[20,26,31,36] </C>
            <C ID="409"> H[0-3] </C>
            <C ID="410"> H[4-7] </C>
        </COMPOSITE>
        <DOMAIN>
            <D ID="0"> C[409] </D>
            <D ID="1"> C[410] </D>
        </DOMAIN>
    </GEOMETRY>
    <Metadata>
        <Provenance>
            <GitBranch>refs/heads/feature/ALE-IP</GitBranch>
            <GitSHA1>44bd22d44648642136d0dcdba53ee4dfb167ce3e</GitSHA1>
            <Hostname>kingscross</Hostname>
            <NektarVersion>5.5.0</NektarVersion>
            <Timestamp>18-Mar-2024 15:12:47</Timestamp>
        </Provenance>
        <NekMeshCommandLine>-m peralign:surf1=401:surf2=402:dir=x -m peralign:surf1=403:surf2=404:dir=y -m peralign:surf1=405:surf2=406:dir=z couette_3D.msh couette_3D.xml:xml:uncompress </NekMeshCommandLine>
    </Metadata>
    <EXPANSIONS>
        <E COMPOSITE="C[409]" NUMMODES="4" TYPE="MODIFIED" FIELDS="rho,rhou,rhov,rhow,E" />
        <E COMPOSITE="C[410]" NUMMODES="4" TYPE="MODIFIED" FIELDS="rho,rhou,rhov,rhow,E" />
    </EXPANSIONS>

    <MOVEMENT>
        <ZONES>
            <FIXED ID="0" DOMAIN="D[0]" />
            <TRANSLATE ID="1" DOMAIN="D[1]" VELOCITY="0,PI*cos(2*PI*t),-PI*cos(2*PI*t)" DISPLACEMENT="0,0.5*sin(2*PI*t),-0.5*sin(2*PI*t)"/>
        </ZONES>
        <INTERFACES>
            <INTERFACE NAME="Interface">
                <LEFT  ID="0" BOUNDARY="C[407]" />
                <RIGHT ID="1" BOUNDARY="C[408]" />
            </INTERFACE>
        </INTERFACES>
    </MOVEMENT>
    <CONDITIONS>
        <PARAMETERS>
            <P> TimeStep              = 0.001                          </P>
            <P> NumSteps              = 10                           </P>
            <P> IO_CheckSteps         = 10                             </P>
            <P> IO_InfoSteps          = 10                             </P>
            <P> IO_CFLSteps           = 10                             </P>
            <P> Gamma                 = 1.4                           </P>
            <P> GasConstant           = 1/1.4                         </P>
            <P> cInf                  = 1                             </P>
            <P> rhoInf                = 1                             </P>
            <P> Mach                  = 0.5                           </P>
            <P> Re                    = 100                           </P>
            <P> Pr                    = 0.72                          </P>
            <P> L                     = 1                             </P>
            <P> NonlinIterTolRelativeL2   = 1.0E-10                   </P>
            <P> NewtonRelativeIteTol      = 1.0E-10                   </P>
            <P> LinSysRelativeTolInNonlin = 1.0E-10                   </P>
            <P> NekNonlinSysMaxIterations = 30                       </P>
            <P> NekLinSysMaxIterations    = 100                        </P>
            <P> PreconMatFreezNumb        = 100                       </P>
            <P> PreconItsStep             = 7                         </P>
            <P> TInf                  = cInf ^ 2 / Gamma / GasConstant</P>
            <P> T0                    = 0.9*TInf                      </P>
            <P> pInf                  = rhoInf * GasConstant * TInf   </P>
            <P> vInf                  = Mach*cInf                     </P>
            <P> uInf                  = 0.0                           </P>
            <P> wInf                  = 0.0                           </P>
            <P> mu                    = Mach / Re                     </P>

        </PARAMETERS>

        <SOLVERINFO>
            <I PROPERTY="EQType"                VALUE="NavierStokesImplicitCFE"/>
            <I PROPERTY="Projection"            VALUE="DisContinuous"       />
            <I PROPERTY="AdvectionType"         VALUE="WeakDG"              />
            <I PROPERTY="DiffusionType"         VALUE="InteriorPenalty"     />
            <I PROPERTY="TimeIntegrationMethod" VALUE="DIRKOrder2"          />
            <I PROPERTY="UpwindType"            VALUE="HLLC"                 />
            <I PROPERTY="ProblemType"           VALUE="General"             />
            <I PROPERTY="ViscosityType"         VALUE="Constant"            />
        </SOLVERINFO>

        <VARIABLES>
            <V ID="0"> rho  </V>
            <V ID="1"> rhou </V>
            <V ID="2"> rhov </V>
            <V ID="3"> rhow </V>
            <V ID="4"> E    </V>
        </VARIABLES>

        <BOUNDARYREGIONS>
            <B ID="0"> C[404] </B>
            <B ID="1"> C[401] </B>
            <B ID="2"> C[403] </B>
            <B ID="3"> C[402] </B>
            <B ID="4"> C[405] </B>
            <B ID="5"> C[406] </B>
        </BOUNDARYREGIONS>

        <BOUNDARYCONDITIONS>
            <REGION REF="1">
                <D VAR="rho"  VALUE="pInf/(GasConstant*T0)" />
                <D VAR="rhou" VALUE="0" />
                <D VAR="rhov" VALUE="0"/>
                <D VAR="rhow" VALUE="0"/>
                <D VAR="E"    VALUE="pInf / (Gamma - 1)" />
            </REGION>
            <REGION REF="3">
                <D VAR="rho"  VALUE="pInf / (GasConstant * TInf)" />
                <D VAR="rhov" VALUE="pInf / (GasConstant * TInf) * vInf" />
                <D VAR="rhou" VALUE="0"/>
                <D VAR="rhow" VALUE="0"/>
                <D VAR="E"    VALUE="pInf / (Gamma - 1) + pInf / (GasConstant * TInf) * 0.5 * vInf * vInf" />
            </REGION>
            <!--       Period -->
            <REGION REF="0">
                <P VAR="rho"  VALUE="[2]" />
                <P VAR="rhou" VALUE="[2]" />
                <P VAR="rhov" VALUE="[2]" />
                <P VAR="rhow" VALUE="[2]" />
                <P VAR="E"    VALUE="[2]" />
            </REGION>
            <REGION REF="2">
                <P VAR="rho"  VALUE="[0]" />
                <P VAR="rhou" VALUE="[0]" />
                <P VAR="rhov" VALUE="[0]" />
                <P VAR="rhow" VALUE="[0]" />
                <P VAR="E"    VALUE="[0]" />
            </REGION>
            <REGION REF="4">
                <P VAR="rho"  VALUE="[5]" />
                <P VAR="rhou" VALUE="[5]" />
                <P VAR="rhov" VALUE="[5]" />
                <P VAR="rhow" VALUE="[5]" />
                <P VAR="E"    VALUE="[5]" />
            </REGION>
            <REGION REF="5">
                <P VAR="rho"  VALUE="[4]" />
                <P VAR="rhou" VALUE="[4]" />
                <P VAR="rhov" VALUE="[4]" />
                <P VAR="rhow" VALUE="[4]" />
                <P VAR="E"    VALUE="[4]" />
            </REGION>
        </BOUNDARYCONDITIONS>

        <FUNCTION NAME="InitialConditions">
            <E VAR="rho"  VALUE="pInf / (GasConstant * (T0 + x/L * (TInf - T0) + x/L * (1.0 - x/L) * Pr * vInf * vInf * (Gamma-1) / (2.0 * Gamma * GasConstant)))" />
            <E VAR="rhov" VALUE="pInf / (GasConstant * (T0 + x/L * (TInf - T0) + x/L * (1.0 - x/L) * Pr * vInf * vInf * (Gamma-1) / (2.0 * Gamma * GasConstant))) * x/L * vInf" />
            <E VAR="rhou" VALUE="0.0" />
            <E VAR="rhow" VALUE="0.0" />
            <E VAR="E"    VALUE="pInf / (Gamma - 1) + 0.5 * pInf / (GasConstant * (T0 + x/L * (TInf - T0) + x/L * (1.0 - x/L) * Pr * vInf * vInf * (Gamma-1) / (2.0 * Gamma * GasConstant))) * (x/L * vInf)^2 " />
        </FUNCTION>

        <FUNCTION NAME="ExactSolution">
            <E VAR="rho"  VALUE="pInf / (GasConstant * (T0 + x/L * (TInf - T0) + x/L * (1.0 - x/L) * Pr * vInf * vInf * (Gamma-1) / (2.0 * Gamma * GasConstant)))" />
            <E VAR="rhov" VALUE="pInf / (GasConstant * (T0 + x/L * (TInf - T0) + x/L * (1.0 - x/L) * Pr * vInf * vInf * (Gamma-1) / (2.0 * Gamma * GasConstant))) * x/L * vInf" />
            <E VAR="rhou" VALUE="0.0" />
            <E VAR="rhow" VALUE="0.0" />
            <E VAR="E"    VALUE="pInf / (Gamma - 1) + 0.5 * pInf / (GasConstant * (T0 + x/L * (TInf - T0) + x/L * (1.0 - x/L) * Pr * vInf * vInf * (Gamma-1) / (2.0 * Gamma * GasConstant))) * (x/L * vInf)^2 " />
        </FUNCTION>
    </CONDITIONS>
</NEKTAR>
